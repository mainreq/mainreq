{% extends "reqApp/base.html" %}
{% load reqApp_tags %}
{% block body %}
<div>
    {% if canEditTasks %}
        Responsable: 
        <select progressbar style="display:inline-block;width:auto;vertical-align:top;" class="selectpicker" data-style="btn-primary" tooltip="Seleccionar Usuario" onchange="location=$(this).val();">
            <option value="?">Seleccionar Usuario</option>
            {% for i,w in workerUsers %}
                <option value="?userIndex={{i}}"{% ifequal userIndex i %}selected{% endifequal %}>Usuario: {{w}}</option>
            {% endfor %}
        </select>
    {% endif %}
    
    Estado: 
    <select progressbar style="display:inline-block;width:auto;vertical-align:top;" class="blue_button" tooltip="Seleccionar Estado" onchange="location=$(this).val();">
        <option value="?userIndex={{ userIndex }}">Seleccionar Estado</option>
        {% for s,n in states %}
            <option {% ifequal state s %}selected{% endifequal %} value="?state={{ s }}&userIndex={{ userIndex }}">{{ n }}</option>
        {% endfor %}
    </select>
    
    <div style="display:inline-block;position:relative;float:right;">
        <a title="Ayuda" class="blue_button" href="{% url 'reqApp:help' %}#{{ helpLink }}" target="_blank">?</a>
    </div>
</div>

<br/>

<div>
    <button title="Expandir Elementos" style="display: inline-block;width:auto;" href='#' class="blue_button" onclick='showContents()'>(+)Abrir Todos</button>
    <button title="Colapsar Elementos" style="display: inline-block;width:auto;" href='#' class="blue_button" onclick='hideContents()'>(--)Cerrar Todos</button>
    <div style="display: inline-block;width:20%;"></div>
    {% if canEditTasks %}
        <a title="Agregar Nueva Tarea" style="display: inline-block;width:auto;" href='#new' class="blue_button" onclick='editNewElement()'>Nueva</a>
    {% endif %}
</div>

{% for msg in msgs %}
    <div class="message">
        {{ msg }}
    </div>
{% endfor %}

<div style="text-align:right;">
    <p>
        <i style="color:Gray;">Tareas:</i>
        <b class="reqLabel label-to_do">{{ tasks|length }}</b>
        <i style="color:Gray;">Estado:</i>
        <b class="reqLabel label-to_do">por hacer</b>
        <b class="reqLabel label-done">realizada</b>
        <b class="reqLabel label-not_done">no realizada</b>
        <b class="reqLabel label-approved">aprobada</b>
        <b class="reqLabel label-reprobate">reprobada</b>
        <b class="reqLabel label-discarded">descartada</b>
    </p>
</div>

{% include ordering_bar with attributes=ordering_attributes actual_order=actual_order getParams=getParams %}

{% ifequal tasks|length 0 %}
    <p class="centered">--------------- No hay Tareas ---------------</p>
{% else %}
    {% for t in tasks %}
                {% include template with task=t canEditTasks=canEditTasks %}
    {% endfor %}
{% endifequal %}

{% if canEditTasks %}
    {% ifequal workerUsers.count 0 %}
        <p class="centered">--------------- No existe un integrante a quien asignarle tareas! ---------------</p>
    {% else %}
        <div class="new_element">
            <a name='new'></a>
            {% include form_template with form=form %}
        </div>
    {% endifequal %}
{% endif %}

<br/><br/><br/><br/><br/><br/>

{% endblock %}
